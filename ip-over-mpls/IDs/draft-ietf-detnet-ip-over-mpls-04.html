<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DetNet Data Plane: IP over MPLS</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Terms Used In This Document">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Abbreviations">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Requirements Language">
<link href="#rfc.section.3" rel="Chapter" title="3 DetNet IP Data Plane Overview">
<link href="#rfc.section.4" rel="Chapter" title="4 IP over DetNet MPLS">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 IP Over DetNet MPLS Data Plane Scenarios">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 DetNet IP over DetNet MPLS Encapsulation">
<link href="#rfc.section.5" rel="Chapter" title="5 IP over DetNet MPLS Procedures">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 DetNet IP over DetNet MPLS Flow Identification                       Procedures">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 DetNet IP over DetNet MPLS Traffic Treatment Procedures">
<link href="#rfc.section.6" rel="Chapter" title="6 Management and Control Information Summary">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative references">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative references">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.12.3 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Varga, B., Ed., Farkas, J., Berger, L., Fedyk, D., Malis, A., Bryant, S., and J. Korhonen" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-detnet-ip-over-mpls-04" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-22" />
  <meta name="dct.abstract" content="This document specifies the Deterministic Networking data plane when operating in an IP over MPLS packet switched network.  " />
  <meta name="description" content="This document specifies the Deterministic Networking data plane when operating in an IP over MPLS packet switched network.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">DetNet</td>
<td class="right">B. Varga, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">J. Farkas</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left">Expires: May 25, 2020</td>
<td class="right">L. Berger</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Fedyk</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">LabN Consulting, L.L.C.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Malis</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Independent</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">S. Bryant</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Futurewei Technologies</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Korhonen</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">November 22, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DetNet Data Plane: IP over MPLS<br />
  <span class="filename">draft-ietf-detnet-ip-over-mpls-04</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies the Deterministic Networking data plane when operating in an IP over MPLS packet switched network.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 25, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Terms Used In This Document</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Abbreviations</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Requirements Language</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">DetNet IP Data Plane Overview</a>
</li>
<li>4.   <a href="#rfc.section.4">IP over DetNet MPLS</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">IP Over DetNet MPLS Data Plane Scenarios</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">DetNet IP over DetNet MPLS Encapsulation</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">IP over DetNet MPLS Procedures</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">DetNet IP over DetNet MPLS Flow Identification                       Procedures</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">DetNet IP over DetNet MPLS Traffic Treatment Procedures</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">Management and Control Information Summary</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<ul><li>10.1.   <a href="#rfc.references.1">Normative references</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative references</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#sec_intro" id="sec_intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Deterministic Networking (DetNet) is a service that can be offered by a network to DetNet flows.  DetNet provides these flows extremely low packet loss rates and assured maximum end-to-end delivery latency.  General background and concepts of DetNet can be found in the DetNet Architecture <a href="#RFC8655" class="xref">[RFC8655]</a>.  </p>
<p id="rfc.section.1.p.2">This document specifies use of the IP DetNet encapsulation over an MPLS network. It maps the IP data plane encapsulation described in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a> to the DetNet MPLS data plane defined in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Terms Used In This Document</h1>
<p id="rfc.section.2.1.p.1">This document uses the terminology and concepts established in the DetNet architecture <a href="#RFC8655" class="xref">[RFC8655]</a> and <a href="#I-D.ietf-detnet-data-plane-framework" class="xref">[I-D.ietf-detnet-data-plane-framework]</a>, and the reader is assumed to be familiar with these documents and their terminology.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Abbreviations</h1>
<p id="rfc.section.2.2.p.1">This document uses the abbreviations defined in the DetNet architecture <a href="#RFC8655" class="xref">[RFC8655]</a> and <a href="#I-D.ietf-detnet-data-plane-framework" class="xref">[I-D.ietf-detnet-data-plane-framework]</a>.  This document uses the following abbreviations: </p>

<dl>
<dt>CE</dt>
<dd style="margin-left: 14">Customer Edge equipment.</dd>
<dt>DetNet</dt>
<dd style="margin-left: 14">Deterministic Networking.</dd>
<dt>DF</dt>
<dd style="margin-left: 14">DetNet Flow.</dd>
<dt>DN</dt>
<dd style="margin-left: 14">DetNet.</dd>
<dt>L2</dt>
<dd style="margin-left: 14">Layer-2.</dd>
<dt>L3</dt>
<dd style="margin-left: 14">Layer-3.</dd>
<dt>LSP</dt>
<dd style="margin-left: 14">Label-switched path.</dd>
<dt>MPLS</dt>
<dd style="margin-left: 14">Multiprotocol Label Switching.</dd>
<dt>PE</dt>
<dd style="margin-left: 14">Provider Edge.</dd>
<dt>PREOF</dt>
<dd style="margin-left: 14">Packet Replication, Ordering and Elimination Function.</dd>
<dt>PSN</dt>
<dd style="margin-left: 14">Packet Switched Network.</dd>
<dt>PW</dt>
<dd style="margin-left: 14">Pseudowire.</dd>
<dt>TE</dt>
<dd style="margin-left: 14">Traffic Engineering.</dd>
<dt>TSN</dt>
<dd style="margin-left: 14">Time-Sensitive Networking, TSN is a Task Group of the IEEE 802.1 Working Group.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Requirements Language</h1>
<p id="rfc.section.2.3.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#sec_dt_dp" id="sec_dt_dp">DetNet IP Data Plane Overview</a>
</h1>
<p><a href="#fig_ip_detnet" class="xref">Figure 1</a> illustrates an IP DetNet, with an MPLS based DetNet network as a sub-network between the relay nodes.  It shows a more complex DetNet enabled IP network where an IP flow is mapped to one or more PWs and MPLS (TE) LSPs.  The end systems still originate IP encapsulated traffic that are identified as DetNet flows.  The relay nodes follow procedures defined in <a href="#ip-over-mpls" class="xref">Section 4</a> to map each DetNet flow to MPLS LSPs. While not shown, relay nodes can provide service sub-layer functions such as PREOF using DetNet over MPLS, and this is indicated by the solid line for the MPLS facing portion of the Service component. Note that the Transit node is MPLS (TE) LSP aware and performs switching based on MPLS labels, and need not have any specific knowledge of the DetNet service or the corresponding DetNet flow identification. See <a href="#ip-over-mpls" class="xref">Section 4</a> for details on the mapping of IP flows to MPLS, and <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a> for general support of DetNet services using MPLS.  </p>
<div id="rfc.figure.1"></div>
<div id="fig_ip_detnet"></div>
<pre>
 DetNet IP       Relay         Transit         Relay      DetNet IP
 End System      Node           Node           Node       End System

+----------+                                             +----------+
|   Appl.  |&lt;------------- End to End Service ----------&gt;|  Appl.   |
+----------+   .....-----+                 +-----.....   +----------+
| Service  |&lt;--: Service |--DetNet flow ---| Service :--&gt;| Service  |
|          |   :         |&lt;-DN MPLS flow -&gt;|         :   |          |
+----------+   +---------+  +----------+   +---------+   +----------+
|Forwarding|   |Fwd| |Fwd|  |Forwarding|   |Fwd| |Fwd|   |Forwarding|
+-------.--+   +-.-+ +-.-+  +----.---.-+   +-.-+ +-.-+   +---.------+
        :  Link  :    /  ,-----.  \   : Link :    /  ,-----.  \
        +........+    +-[  Sub  ]-+   +......+    +-[  Sub  ]-+
                        [Network]                   [Network]
                         `-----'                     `-----'

                     |&lt;---- DetNet MPLS ----&gt;|
         |&lt;--------------------- DetNet IP ------------------&gt;|
                         </pre>
<p class="figure">Figure 1: DetNet IP Over DetNet MPLS Network</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#ip-over-mpls" id="ip-over-mpls">IP over DetNet MPLS</a>
</h1>
<p id="rfc.section.4.p.1">This section defines how IP encapsulated flows are carried over a DetNet MPLS data plane as defined in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>.  Since both Non-DetNet and DetNet IP packet are identical on the wire, this section is applicable to any node that supports IP over DetNet MPLS, and this section refers to both cases as DetNet IP over DetNet MPLS.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#sec_ip_mpls_dt_dp_scen" id="sec_ip_mpls_dt_dp_scen">IP Over DetNet MPLS Data Plane Scenarios</a>
</h1>
<p id="rfc.section.4.1.p.1">An example use of DetNet IP over DetNet MPLS is presented here.  </p>
<p><a href="#fig_ip_detnet" class="xref">Figure 1</a> illustrated DetNet enabled End Systems (hosts), connected to DetNet (DN) enabled IP networks, operating over a DetNet aware MPLS network.  Using this figure we can have a case where the Relay nodes act as T-PEs and sit at the boundary of the MPLS domain since the non-MPLS domain is DetNet aware.  This case is very similar to the DetNet MPLS Network figure 2 in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>.  However in  <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>  figure 2 the T-PEs are located at the end system and MPLS spans the whole DetNet service.  The primary difference in this document is that the Relay nodes are at the edges of the MPLS domain and therefore function as T-PEs, and that MPLS service sub-layer functions are not provided over the DetNet IP network.  The transit node functions show above are identical to those described in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>.  </p>
<p><a href="#fig_ip_pw_detnet" class="xref">Figure 2</a> illustrates how relay nodes can provide service protection over an MPLS domain.  In this case, CE1 and CE2 are IP DetNet end systems which are interconnected via a MPLS domain such as described in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>. Note that R1 and R3 sit at the edges of an MPLS domain and therefore are similar to T-PEs, while R2 sits in the middle of the domain and is therefore similar to an S-PE.  </p>
<div id="rfc.figure.2"></div>
<div id="fig_ip_pw_detnet"></div>
<pre>
      DetNet                                         DetNet
IP    Service         Transit          Transit       Service  IP
DetNet               |&lt;-Tnl-&gt;|        |&lt;-Tnl-&gt;|               DetNet
End     |            V   1   V        V   2   V            |  End
System  |   +--------+       +--------+       +--------+   |  System
+---+   |   |   R1   |=======|   R2   |=======|   R3   |   |   +---+
|   |-------|._X_....|..DF1..|.__ ___.|..DF3..|...._X_.|-------|   |
|CE1|   |   |    \   |       |   X    |       |   /    |   |   |CE2|
|   |   |   |     \_.|..DF2..|._/ \__.|..DF4..|._/     |   |   |   |
+---+       |        |=======|        |=======|        |       +---+
    ^       +--------+       +--------+       +--------+       ^
    |        Relay Node       Relay Node       Relay Node      |
    |          (T-PE)           (S-PE)          (T-PE)         |
    |                                                          |
    |&lt;-DN IP-&gt; &lt;-------- DetNet MPLS ---------------&gt; &lt;-DN IP-&gt;|
    |                                                          |
    |&lt;-------------- End to End DetNet Service ---------------&gt;|

   -------------------------- Data Flow -------------------------&gt;

    X   = Service protection (PRF, PREOF, PEF/POF)
    DFx = DetNet member flow x over a TE LSP
    </pre>
<p class="figure">Figure 2: DetNet IP Over DetNet MPLS Network</p>
<p><a href="#fig_ip_detnet" class="xref">Figure 1</a> illustrates DetNet enabled End Systems, connected to DetNet (DN) enabled MPLS network.  A similar situation occurs when end systems are are not DetNet aware.  In this case, edge nodes sit at the boundary of the MPLS domain since it is also a DetNet domain boundary.  The edge nodes provide DetNet service proxies for the end applications by initiating and terminating DetNet service for the application's IP flows.  While the node types differ, there is essentially no difference in data plane processing between relay and edges.  There are likely to be differences in controller plane operation, particularly when distributed control plane protocols are used.  </p>
<p id="rfc.section.4.1.p.5">It is still possible to provided DetNet service protection for non-DetNet aware end systems. This case is basically the same as <a href="#fig_ip_pw_detnet" class="xref">Figure 2</a>, with the exception that CE1 and CE2 are non-DetNet aware end systems and R1 and R3 become edge nodes.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#iom-overview" id="iom-overview">DetNet IP over DetNet MPLS Encapsulation</a>
</h1>
<p id="rfc.section.4.2.p.1">The basic encapsulation approach is to treat a DetNet IP flow as an app-flow from the DetNet MPLS perspective. The corresponding example DetNet Sub-Network format is shown in <a href="#fig_dn_ip_mpls_sn_ex" class="xref">Figure 3</a>.  </p>
<div id="rfc.figure.3"></div>
<div id="fig_dn_ip_mpls_sn_ex"></div>
<pre>

           /-&gt;     +------+  +------+  +------+            ^ ^
           |       |  X   |  |  X   |  |  X   |&lt;- App-Flow : :
           |       +------+  +------+  +------+            : :
App-Flow &lt;-+       |NProto|  |NProto|  |NProto|            : :(1)
 for MPLS  |       +------+  +------+  +------+            : :
           |       |  IP  |  |  IP  |  |  IP  |            : v
           \-&gt; +---+======+--+======+--+======+-----+      :
DetNet-MPLS        | d-CW |  | d-CW |  | d-CW |            :
                   +------+  +------+  +------+            :(2)
                   |Labels|  |Labels|  |Labels|            v
               +---+======+--+======+--+======+-----+
Link/Sub-Network   |  L2  |  | TSN  |  | UDP  |
                   +------+  +------+  +------+
                                       |  IP  |
                                       +------+
                                       |  L2  |
                                       +------+
    (1) DetNet IP Flow (or simply IP flow)
    (2) DetNet MPLS Flow
    
        </pre>
<p class="figure">Figure 3: Example DetNet IP over MPLS Sub-Network Formats</p>
<p id="rfc.section.4.2.p.2">In <a href="#fig_dn_ip_mpls_sn_ex" class="xref">Figure 3</a> "App-Flow" indicates the payload carried by the DetNet IP data plane.  "IP" and "NProto" indicate the fields described in Section 5.1.1. IP Header Information and Section 5.1.2.  Other Protocol Header Information in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a>, respectively.  "App-Flow for MPLS" indicates that an individual DetNet IP flow is the payload from the perspective of the DetNet MPLS data plane defined in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>.  </p>
<p id="rfc.section.4.2.p.3">Per <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>, the DetNet MPLS data plane uses a single S-Label to support a single app flow. Section 5.1. DetNet IP Flow Identification Procedures in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a> states that a single DetNet flow is identified based on IP, and next level protocol, header information.  Section 4.4. Aggregation Considerations in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a> defines the ways in which aggregation is supported through the use of prefixes, wildcards, lists, and port ranges.  Collectively, this results in the fairly straightforward procedures defined in this section.  </p>
<p id="rfc.section.4.2.p.4">As shown in <a href="#fig_ip_pw_detnet" class="xref">Figure 2</a>, DetNet relay nodes are responsible for the mapping of a DetNet flow, at the service sub-layer, from the IP to MPLS DetNet data planes and back again. Their related DetNet IP over DetNet MPLS data plane operation is comprised of two sets of procedures: the mapping of flow identifiers, and ensuring proper traffic treatment.  </p>
<p id="rfc.section.4.2.p.5">Mapping of IP to DetNet MPLS is similar for DetNet IP flows and IP flows.  The six-tuple of IP is mapped to the S-Label in both cases.  The various fields may be mapped or ignored when going from IP to MPLS.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iom-proc" id="iom-proc">IP over DetNet MPLS Procedures</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#iom-ids" id="iom-ids">DetNet IP over DetNet MPLS Flow Identification                       Procedures</a>
</h1>
<p id="rfc.section.5.1.p.1">A DetNet relay node (ingress T-PE) that sends a DetNet IP flow over a DetNet MPLS network MUST map a DetNet IP flow, as identified in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a> into a single MPLS DetNet flow and MUST process it in accordance to the procedures defined in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a> Section 6.1.  PRF MAY be supported at the MPLS level for DetNet IP flows sent over an DetNet MPLS network.  Aggregation MAY be supported as defined in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a> Section 5.4. Aggregation considerations in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a> MAY be used to identify an individual DetNet IP flow. The provisioning of the mapping of DetNet IP flows to DetNet MPLS flows MUST be supported via configuration, e.g., via the controller plane.  </p>
<p id="rfc.section.5.1.p.2">A DetNet relay node (egress T-PE) MAY be provisioned to handle packets received via the DetNet MPLS data plane as DetNet IP flows.  A single incoming DetNet MPLS flow MAY be treated as a single DetNet IP flow, without examination of IP headers. Alternatively, packets received via the DetNet MPLS data plane MAY follow the normal DetNet IP flow identification procedures defined in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a>  Section 7.1.  </p>
<p id="rfc.section.5.1.p.3">An implementation MUST support the provisioning for handling any received DetNet MPLS data plane as DetNet IP flows via configuration.  Note that such configuration MAY include support from PREOF on the incoming DetNet MPLS flow.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#iom-svc" id="iom-svc">DetNet IP over DetNet MPLS Traffic Treatment Procedures</a>
</h1>
<p id="rfc.section.5.2.p.1">The traffic treatment required for a particular DetNet IP flow is provisioned via configuration or the controller plane. When a DetNet IP flow is sent over DetNet MPLS, a DetNet relay node MUST ensure that the provisioned DetNet IP traffic treatment is provided at the forwarding sub-layer as described in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a> Section 5.2. Note that the PRF function MAY be utilized when sending IP over MPLS.  </p>
<p id="rfc.section.5.2.p.2">Traffic treatment for DetNet IP flows received over the DetNet MPLS data plane MUST follow Section 5.3 DetNet IP Traffic Treatment Procedures in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a>.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#mc_summary" id="mc_summary">Management and Control Information Summary</a>
</h1>
<p id="rfc.section.6.p.1">The following summarizes the set of information that is needed to support DetNet IP over DetNet MPLS at the MPLS ingress node: </p>

<ul>
<li>Each MPLS App-Flow is identified using the IP flow identification information as defined in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a>. The information is summarized in Section 5.1 of that document, and includes all wildcards, port ranges and the ability to ignore specific IP fields.  </li>
<li>The DetNet MPLS service that is to be used to send the matching IP traffic.  This matching information is provided in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a> Section 5.1, and includes both service and traffic delivery information.  </li>
</ul>

<p> </p>
<p id="rfc.section.6.p.2">The following summarizes the set of information that is needed to support DetNet IP over DetNet MPLS at the MPLS egress node: </p>

<ul>
<li>S-Label values that are carrying MPLS over IP encapsulated traffic.  </li>
<li>For each S-Label, how the received traffic is to be handled. The traffic may be processed according as any other DetNet IP traffic as defined in this document or in <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a>, or the traffic may be directly treated as an MPLS App-flow for additional processing according to  <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a>.  </li>
</ul>

<p> </p>
<p id="rfc.section.6.p.3">It is the responsibility of the DetNet controller plane to properly provision both flow identification information and the flow specific resources needed to provided the traffic treatment needed to meet each flow's service requirements.  This applies for aggregated and individual flows.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Security Considerations</h1>
<p id="rfc.section.7.p.1">This draft does not have additional security considerations.  Security considerations for DetNet are described in detail in <a href="#I-D.ietf-detnet-security" class="xref">[I-D.ietf-detnet-security]</a>. General security considerations are described in <a href="#RFC8655" class="xref">[RFC8655]</a>.  MPLS and IP specific considerations are described in <a href="#I-D.ietf-detnet-mpls" class="xref">[I-D.ietf-detnet-mpls]</a> and <a href="#I-D.ietf-detnet-ip" class="xref">[I-D.ietf-detnet-ip]</a>.  </p>
<p id="rfc.section.7.p.2">Security aspects which are unique to DetNet are those whose aim is to provide the specific quality of service aspects of DetNet, which are primarily to deliver data flows with extremely low packet loss rates and bounded end-to-end delivery latency.  </p>
<p id="rfc.section.7.p.3">The primary considerations for the data plane is to maintain integrity of data and delivery of the associated DetNet service traversing the DetNet network.  Application flows can be protected through whatever means is provided by the underlying technology. For example, encryption may be used, such as that provided by IPSec <a href="#RFC4301" class="xref">[RFC4301]</a> for IP flows and/or by an underlying sub-net using MACSec <a href="#IEEE802.1AE-2018" class="xref">[IEEE802.1AE-2018]</a> for IP over Ethernet (Layer-2) flows.  </p>
<p id="rfc.section.7.p.4">From a data plane perspective this document does not add or modify any header information.  </p>
<p id="rfc.section.7.p.5">At the management and control level DetNet flows are identified on a per-flow basis, which may provide controller plane attackers with additional information about the data flows (when compared to controller planes that do not include per-flow identification).  This is an inherent property of DetNet which has security implications that should be considered when determining if DetNet is a suitable technology for any given use case.  </p>
<p id="rfc.section.7.p.6">To provide uninterrupted availability of the DetNet service, provisions can be made against DOS attacks and delay attacks. To protect against DOS attacks, excess traffic due to malicious or malfunctioning devices can be prevented or mitigated, for example through the use of existing mechanism such as policing and shaping applied at the input of a DetNet domain. To prevent DetNet packets from being delayed by an entity external to a DetNet domain, DetNet technology definition can allow for the mitigation of Man-In-The-Middle attacks, for example through use of authentication and authorization of devices within the DetNet domain.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">This document makes no IANA requests.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#acks" id="acks">Acknowledgements</a>
</h1>
<p id="rfc.section.9.p.1">The authors wish to thank Pat Thaler, Norman Finn, Loa Anderson, David Black, Rodney Cummings, Ethan Grossman, Tal Mizrahi, David Mozes, Craig Gunther, George Swallow, Yuanlong Jiang and Carlos J. Bernardos for their various contributions to this work.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative references</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-detnet-ip">[I-D.ietf-detnet-ip]</b></td>
<td class="top">
<a>Varga, B.</a>, <a>Farkas, J.</a>, <a>Berger, L.</a>, <a>Fedyk, D.</a>, <a>Malis, A.</a>, <a>Bryant, S.</a> and <a>J. Korhonen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-detnet-ip-03">DetNet Data Plane: IP</a>", Internet-Draft draft-ietf-detnet-ip-03, October 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-detnet-mpls">[I-D.ietf-detnet-mpls]</b></td>
<td class="top">
<a>Varga, B.</a>, <a>Farkas, J.</a>, <a>Berger, L.</a>, <a>Fedyk, D.</a>, <a>Malis, A.</a>, <a>Bryant, S.</a> and <a>J. Korhonen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-detnet-mpls-03">DetNet Data Plane: MPLS</a>", Internet-Draft draft-ietf-detnet-mpls-03, October 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8655">[RFC8655]</b></td>
<td class="top">
<a>Finn, N.</a>, <a>Thubert, P.</a>, <a>Varga, B.</a> and <a>J. Farkas</a>, "<a href="https://tools.ietf.org/html/rfc8655">Deterministic Networking Architecture</a>", RFC 8655, DOI 10.17487/RFC8655, October 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative references</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-detnet-data-plane-framework">[I-D.ietf-detnet-data-plane-framework]</b></td>
<td class="top">
<a>Varga, B.</a>, <a>Farkas, J.</a>, <a>Berger, L.</a>, <a>Fedyk, D.</a>, <a>Malis, A.</a>, <a>Bryant, S.</a> and <a>J. Korhonen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-detnet-data-plane-framework-03">DetNet Data Plane Framework</a>", Internet-Draft draft-ietf-detnet-data-plane-framework-03, October 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-detnet-security">[I-D.ietf-detnet-security]</b></td>
<td class="top">
<a>Mizrahi, T.</a>, <a>Grossman, E.</a>, <a>Hacker, A.</a>, <a>Das, S.</a>, <a>Dowdell, J.</a>, <a>Austad, H.</a> and <a>N. Finn</a>, "<a href="https://tools.ietf.org/html/draft-ietf-detnet-security-06">Deterministic Networking (DetNet) Security Considerations</a>", Internet-Draft draft-ietf-detnet-security-06, November 2019.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE802.1AE-2018">[IEEE802.1AE-2018]</b></td>
<td class="top">
<a>IEEE Standards Association</a>, "<a href="https://ieeexplore.ieee.org/document/8585421">IEEE Std 802.1AE-2018 MAC Security (MACsec)</a>", 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4301">[RFC4301]</b></td>
<td class="top">
<a>Kent, S.</a> and <a>K. Seo</a>, "<a href="https://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>", RFC 4301, DOI 10.17487/RFC4301, December 2005.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Bal&#225;zs Varga</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Varga</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span class="vcardline">Magyar Tudosok krt. 11.</span>

	  <span class="vcardline">
		<span class="locality">Budapest</span>,  
		<span class="region"></span>
		<span class="code">1117</span>
	  </span>
	  <span class="country-name vcardline">Hungary</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:balazs.a.varga@ericsson.com">balazs.a.varga@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">J&#225;nos Farkas</span> 
	  <span class="n hidden">
		<span class="family-name">Farkas</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span class="vcardline">Magyar Tudosok krt. 11.</span>

	  <span class="vcardline">
		<span class="locality">Budapest</span>,  
		<span class="region"></span>
		<span class="code">1117</span>
	  </span>
	  <span class="country-name vcardline">Hungary</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:janos.farkas@ericsson.com">janos.farkas@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lou Berger</span> 
	  <span class="n hidden">
		<span class="family-name">Berger</span>
	  </span>
	</span>
	<span class="org vcardline">LabN Consulting, L.L.C.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lberger@labn.net">lberger@labn.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Don Fedyk</span> 
	  <span class="n hidden">
		<span class="family-name">Fedyk</span>
	  </span>
	</span>
	<span class="org vcardline">LabN Consulting, L.L.C.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dfedyk@labn.net">dfedyk@labn.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andrew G. Malis</span> 
	  <span class="n hidden">
		<span class="family-name">Malis</span>
	  </span>
	</span>
	<span class="org vcardline">Independent</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:agmalis@gmail.com">agmalis@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stewart Bryant</span> 
	  <span class="n hidden">
		<span class="family-name">Bryant</span>
	  </span>
	</span>
	<span class="org vcardline">Futurewei Technologies</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:stewart.bryant@gmail.com">stewart.bryant@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jouni Korhonen</span> 
	  <span class="n hidden">
		<span class="family-name">Korhonen</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jouni.nospam@gmail.com">jouni.nospam@gmail.com</a></span>

  </address>
</div>

</body>
</html>
